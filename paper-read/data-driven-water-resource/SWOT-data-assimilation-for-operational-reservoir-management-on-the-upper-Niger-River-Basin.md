# 引言
大坝设计用来蓄水，随后可以泄流来满足发电、供水、防洪、灌溉、航运、娱乐等需求。随着对水库的需求的增加，水资源越发稀缺，优化水库的蓄泄变得愈发重要。最近几十年，环境需水量越来越受重视，这部分需水通常以最小下泄流量的方式出现来满足下游的最小入流需求。河流内的径流传播依赖于许多因素，比如距离、河道的物理特性（断面几何形状，坡度、糙率）、入流和出流。特别在大流域，水流时滞可从几天到几周的时间。对于实时水库管理，这些因素必须被考虑进优化调度中。适应性的自动化控制可以用来计算优化调度方案，它处理了多目标和约束，比如约束于特定位置的最小流量的最大供水。

然而，这些模型或控制器的表现受限于我们对河道和水库下游平原的了解，且受边界条件（比如，水库入流和未被测量的支流，降雨和蒸发）深刻影响。两种方法可以被采取减少上游和侧面的边界条件误差的影响。第一是用于预测水库入流的水文模型的参数率定，它可以基于历史观测。第二是同化观测以矫正模型误差的影响。一个共同的问题是实时数据的可用性，这代表着水库上下游河流的水力状态（比如，水位、河长、表面坡度）。这在非洲的大河尤其突出，因为它有很少的实时监测网络。例如，在尼日尔河流域，马里境内干流的测点间距离约200km，尼日利亚境内约600km。实时交流是另一个问题，它会使水库调节的性能退化。当地一些观测系统传感器包括远程通信；然而，许多测站测量是手动进行的，就像水库调度者间的交流一样。此外，即使是在偏远地区有现场记录和传输能力的情况下，数据传输也可能会延迟几天或几星期。当没有实时数据可用时，水库管理者通常使用一些预定义的水库规则来决定水库调度。这些规则是基于历史时间序列和管理者经验的，在没有数据的地区可以用经验模拟。虽然水库调度规则在季节性管理中能很好地适用，但是在实时情景下主要的限制在于河流的真实状态没有被考虑，这会导致在干旱年份出现不充足的径流或雨水充足的年份径流过量。

近些年遥感技术的发展正给水文和遥感带来新的观点，比如从卫星图像中查看作物监测或者从测高法中进行洪水预报。由NASA和CNES联合的，已经计划的地表水和海洋地形卫星计划SWOT，会更进一步地促进这些应用。主要的SWOT工具会是一个广泛的测高仪，它会在一个前所未有的空间分辨率（50-100m）和精度（平均超过一千平方公里范围内厘米级垂直精度）下提供水面高程和长宽地图。SWOT数据在水文科学领域潜在的应用尽量已经被数位作者证实了。Andreadis等使用集合卡尔曼滤波方法同化SWOT虚拟观测到一个水力学模型来减少俄亥俄河的一段河流由于横向径流不确定性导致的建模误差。类似的方法被Biancamaria成功应用于修改俄亥俄河的水表面高程。其他的研究关注于童工SWOT数据同化的河流特性模拟。在全球尺度上，Biancamaria等关注SWOT的时间采样，使用rating曲线表征化了河宽超过50m的河流的径流模拟的误差。

以前评价了SWOT水文应用的潜力的研究已经关注与地表水体的特征或水位和流量模拟的提升。SWOT测量在调度领域的潜在使用，比如洪水预报和水资源管理，有两个原因。第一是SWOT数据的机会使用十分可能，即使在科学任务领域。第二是SWOT代表一种技术方面的基础性变化，从nadir pointing高度计变为swath高度计，这对水文和水资源等各种领域都有重要的意味。很可能swath高度计会成为未来的一种标准，在这种意义下，SWOT能可以被认为是一个未来应用的试验场。重要地是注意SWOT不打算用于一个调度任务，而是一个科学任务来证实swath高度计和潜能。然而，整体SWOT数据流中的一小部分会供来制作近似实时版本。此外，如果任务成功，操作后续任务会得到发展，会伴随类似于对气象卫星的发展的对调度方法的研究。操作的卫星任务通常提供24h或少些的数据，这是我们接下来要展示的模拟的基础。

水库调度对下游有影响，且对环境影响有增长的关心。然而，他们运营于仅部分被观测和部分调度控制的系统中。虽然水库管理者能关系而他们自己的水库库容和入库径流，但对下游的条件并不清楚，包括对下游支流的入流，抽象下游和其他设备的调度。本文的研究展示了远程观测数据如SWOT如何用于部分填补知识的空白和提升调度。我们的目标是调查SWOT观测对水库调度的潜在应用，以及SWOT和调度的结合给下游径流带来的影响。在之前的研究中，我们使用了一个孪生实验，包括一个真实的模拟，从中合成的SWOT观测被得到，和一个破坏的模拟，其中，合成的SWOT数据（包括模拟误差）被同化。两个模拟都基于一个耦合的水文-水力-水库模型，这个模型代表降雨到径流，到水流演进，到水库水体变化的转化。水库下泄通过一个自动控制器决定，在真实和破坏的两个模拟中都实现。控制器考虑河流状态和水库状态，也考虑水库和下游最小流量约束点的河流动态。我们使用模型预测控制（MPC）框架，在对河流和水库的SWOT观察数据同化后，在每一阶段都有一个简化的路由模型被初始化。最后，这个简化的路由模型用于一个优化循环来决定满足下游最小下泄约束的最小下泄流量。结果表明，与以前类似的研究相比，真实模拟不独立于MPC的同化过程，因为它被大坝调节影响。

我们应用上述方法在尼日尔河上游流域，从Banankoro到Kirango。Selingue水库，坐落于Banankoro临近支流，用于发电和枯水期Kirango以及Noger Inner Delta的补水。在探索分析中，在Kirango我们表示一个低流量约束，发电量最大等管理目标也加入到MPC框架中。虽然在situ数据可用，但是这些数据在传输过程中有断代和延迟，遥感数据是一个潜在的选择，并能提供补充的信息。本文中，我们使用历史数据做模型校验，模型假设完好。扩展我们的方法到无测量区域需要更多的模型校验，虽然我们注意到基于遥感数据的新的校验技术正在发展，并可能对本问题有用。

论文的剩余部分这样组织：第二部分描述研究区域和可用数据。第三部分详细阐述方法，包括建模框架，SWOT观测的合成，同化框架和自动控制器。最后结果在第4部分展示。

# 研究区域和可用数据
非洲第三大河Niger河，上游流域有一个大型水库Selingue，有21亿立方米库容，1982年来就运行了，年平均径流80亿立方米。一个更大的大坝在Guinea，Niger和支流上正在计划中，为了来满足Guinea和Mali日益增长的农业和发电需求。

Niger河径流的季节性变化主要受季风影响，上一纪，季风为Koulikoro上游流域带来1500mm的平均降雨，和1000m^3/s的平均流量。枯水期从12月到6月。水库下泄主要用于大点，但也有灌溉需求。水库下泄流量的效果可达下游360km，到Markala。枯水期河道内时滞约30天。

Markala一个径流式水库，Kirango上游几公里，有极有限的库容，但它抬高了平原水位约5.5m使得约100000ha的庄稼地得到灌溉。Markala下游，测站需要最小50m^3/s的流量，一个环保流量以保护水生生物。

维持这个径流需要Selingue的下泄来补偿这部分的取水。然而不论是取水还是支流流量都没有测量，这使得水量必须根据河流径流模拟来进行释放。监测网络被马里的一个公司管理。在Selinge和Markala之间，水位通过7个测站的水位计读取，目前还没有自动记录和数据传输的能力。仅仅在Koulikoro有自动化的水位传感器和数据传输设备。实时空间观测数据的缺失影响水库系统满足环境需求的能力。正如我们接下来要展示的，这些缺失可以通过SWOT数据的使用来弥补。

在本文的研究范围内，流量测量可通过四个测站获得：Banankoro、Selingue、Koulikoro和Kirango。从Banakoro站获取的数据由全球径流数据中心GRDC提供，其他三个站的数据由法国IRD提供。径流测量用来校验模型。大流量主要有Banankoro的入流控制。在枯水期，Banankoro地狱50m^3/s，Koulikoro和Kirango的径流主要通过Swlingue大坝的下泄满足。同样地，Kirango的径流远远小于Koulikoro，这主要是由于Markala的分流和蒸发损失。

# 方法
## 概述
为了获取SWOT数据潜在的效益用以Niger上游水库系统的调度，我们开发了一个模型框架，设计来在给定约束下，同化人工的SWOT水位观测数据，来进行水库下泄的实时调度。主要模型有三个部分，模拟（1）上游和横向流域的径流（2）河流径流在上游大坝和下游低流量控制点间河道内的传播（3）水库的动态（库容和水位变化）
因为目前还没有可用的SWOT观测数据，我们基于历史数据设置了一个孪生实验。模型通过过去的气象观测运行来模拟真实的状态，然后用于生成人工合成的SWOT观测数据。通过增加噪声生成另一个有破坏的气象观测，并用于相同的模型计算有破坏的模型状态，代表最好的调度估计。孪生实验设置也允许不同水库下泄情景的模拟。重要的是注意仅仅气象数据是破坏的，而不是模型自身的结构或参数。这意味着假设模型误差和输入数据相比是可以忽略的。尽管这显然是一个简化的假设，我们的模型率定结果表明事实上大多数模型误差与模型作用力误差相关。

我们使用kalman滤波来同化人工生成的SWOT水位来修正模型的状态缺陷。结果是，在每一个时间段，管理者应该有一个可靠的河流和水库状态的模拟。这个信息，连同潜在的未来降雨，被用于计算优化水库下泄，使得满足下游的最小下泄需求。潜在的未来降雨由气象中心提供。因为在上游Niger流域，枯水期几乎没有降雨，我们使用历史观测代替未来降雨。
